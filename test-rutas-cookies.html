<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Rutas Banner de Cookies</title>
  <link rel="stylesheet" href="assets/css/cookie-banner.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f5f5f5;
    }
    .test-content {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .info-box {
      background: #e3f2fd;
      padding: 15px;
      border-radius: 5px;
      margin: 20px 0;
      border-left: 4px solid #2196f3;
    }
    .route-info {
      background: #f3e5f5;
      padding: 15px;
      border-radius: 5px;
      margin: 15px 0;
      border-left: 4px solid #9c27b0;
    }
    .test-button {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 10px;
    }
    .test-button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <div class="test-content">
    <h1>Test de Rutas del Banner de Cookies</h1>
    
    <div class="info-box">
      <h3>Información de la página actual:</h3>
      <p><strong>URL completa:</strong> <span id="full-url"></span></p>
      <p><strong>Pathname:</strong> <span id="pathname"></span></p>
      <p><strong>Directorio actual:</strong> <span id="current-dir"></span></p>
    </div>
    
    <div class="route-info">
      <h3>Ruta calculada para política de cookies:</h3>
      <p><strong>Ruta generada:</strong> <span id="policy-route"></span></p>
      <p><strong>Enlace completo:</strong> <span id="full-link"></span></p>
    </div>
    
    <h2>Instrucciones:</h2>
    <ol>
      <li>El banner de cookies debe aparecer automáticamente</li>
      <li>Haz clic en el enlace "política de cookies" del banner</li>
      <li>Verifica que se abra correctamente la página de política</li>
      <li>Si no funciona, revisa la ruta generada arriba</li>
    </ol>
    
    <h2>Botones de prueba:</h2>
    <button class="test-button" onclick="mostrarBannerNuevamente()">Mostrar Banner Nuevamente</button>
    <button class="test-button" onclick="limpiarCookies()">Limpiar Cookies</button>
    <button class="test-button" onclick="verRutasCalculadas()">Ver Rutas Calculadas</button>
    
    <div class="info-box">
      <h3>Debug del banner:</h3>
      <div id="banner-debug"></div>
    </div>
  </div>

  <script src="assets/js/analytics.js"></script>
  <script>
    // Función para mostrar información de la página
    function mostrarInfoPagina() {
      document.getElementById('full-url').textContent = window.location.href;
      document.getElementById('pathname').textContent = window.location.pathname;
      
      const pathParts = window.location.pathname.split('/');
      const currentDir = pathParts.slice(0, -1).join('/') || '/';
      document.getElementById('current-dir').textContent = currentDir;
    }
    
    // Función para calcular y mostrar la ruta de la política
    function calcularRutaPolitica() {
      const currentPath = window.location.pathname;
      let policyUrl;
      
      if (currentPath.includes('/producto/')) {
        policyUrl = '../../legal/uso-cookies.html';
      } else if (currentPath.includes('/quienes-somos/') || currentPath.includes('/por-que-aznar/') || 
                 currentPath.includes('/responsabilidad-corporativa/') || currentPath.includes('/contract/')) {
        policyUrl = '../../legal/uso-cookies.html';
      } else if (currentPath.includes('/legal/')) {
        policyUrl = 'uso-cookies.html';
      } else {
        policyUrl = '../legal/uso-cookies.html';
      }
      
      document.getElementById('policy-route').textContent = policyUrl;
      
      // Crear URL completa para verificar
      const baseUrl = window.location.origin;
      const fullLink = baseUrl + window.location.pathname.replace(/\/[^\/]*$/, '/') + policyUrl;
      document.getElementById('full-link').textContent = fullLink;
    }
    
    // Función para mostrar el banner nuevamente
    function mostrarBannerNuevamente() {
      if (document.getElementById('cookie-banner')) {
        document.getElementById('cookie-banner').remove();
      }
      mostrarBannerCookies();
    }
    
    // Función para limpiar cookies
    function limpiarCookies() {
      localStorage.removeItem("cookies_decision");
      localStorage.removeItem("cookies_timestamp");
      location.reload();
    }
    
    // Función para ver rutas calculadas
    function verRutasCalculadas() {
      calcularRutaPolitica();
    }
    
    // Función para mostrar debug del banner
    function mostrarDebugBanner() {
      const banner = document.getElementById('cookie-banner');
      const debugDiv = document.getElementById('banner-debug');
      
      if (banner) {
        const link = banner.querySelector('.cookie-link');
        debugDiv.innerHTML = `
          <p><strong>Banner presente:</strong> SÍ</p>
          <p><strong>Enlace encontrado:</strong> ${link ? 'SÍ' : 'NO'}</p>
          <p><strong>Href del enlace:</strong> ${link ? link.href : 'N/A'}</p>
          <p><strong>Texto del enlace:</strong> ${link ? link.textContent : 'N/A'}</p>
        `;
      } else {
        debugDiv.innerHTML = '<p><strong>Banner presente:</strong> NO</p>';
      }
    }
    
    // Ejecutar cuando se carga la página
    document.addEventListener('DOMContentLoaded', function() {
      mostrarInfoPagina();
      calcularRutaPolitica();
      
      // Mostrar debug después de un pequeño delay para que el banner se cargue
      setTimeout(() => {
        mostrarDebugBanner();
      }, 500);
    });
  </script>
</body>
</html>
